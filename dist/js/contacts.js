import{g}from"./app.js";import{f as n}from"./_functions.js";function p(){function l(){const r=document.forms;if(r.length)for(const t of r)t.hasAttribute("data-fls-form-novalidate")||t.setAttribute("novalidate",!0),t.addEventListener("submit",function(o){const s=o.target;e(s,o)}),t.addEventListener("reset",function(o){const s=o.target;n.formClean(s)});async function e(t,o){if(n.getErrors(t)===0)if(t.dataset.flsForm==="ajax"){o.preventDefault();const a=t.getAttribute("action")?t.getAttribute("action").trim():"#",u=t.getAttribute("method")?t.getAttribute("method").trim():"GET",m=new FormData(t);t.classList.add("--sending");const f=await fetch(a,{method:u,body:m});if(f.ok){let c=await f.json();t.classList.remove("--sending"),i(t,c)}else t.classList.remove("--sending")}else t.dataset.flsForm==="dev"&&(o.preventDefault(),i(t));else if(o.preventDefault(),t.querySelector(".--form-error")&&t.hasAttribute("data-fls-form-gotoerr")){const a=t.dataset.flsFormGotoerr?t.dataset.flsFormGotoerr:".--form-error";g(a)}}function i(t,o=""){document.dispatchEvent(new CustomEvent("formSent",{detail:{form:t}})),setTimeout(()=>{if(window.flsPopup){const s=t.dataset.flsFormPopup;s&&window.flsPopup.open(s)}},0),n.formClean(t)}}function d(){document.body.addEventListener("focusin",function(r){const e=r.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.add("--form-focus"),e.parentElement.classList.add("--form-focus"),n.removeError(e)),e.hasAttribute("data-fls-form-validatenow")&&n.removeError(e))}),document.body.addEventListener("focusout",function(r){const e=r.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA")&&(e.hasAttribute("data-fls-form-nofocus")||(e.classList.remove("--form-focus"),e.parentElement.classList.remove("--form-focus")),e.hasAttribute("data-fls-form-validatenow")&&n.validateInput(e))})}l(),d()}document.querySelector("[data-fls-form]")&&window.addEventListener("load",p);
